{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 174,
   "metadata": {},
   "outputs": [],
   "source": [
    "# importing of rquired libar\n",
    "import pandas as pd \n",
    "from nltk.corpus import stopwords\n",
    "from string import punctuation # importing punctuation marks\n",
    "from sklearn.feature_extraction.text import CountVectorizer\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.linear_model import LogisticRegression # importing model\n",
    "import joblib\n",
    "from scipy.sparse import csr_matrix, isspmatrix\n",
    "import numpy as np\n",
    "    \n",
    "# preparing a list of stopwords\n",
    "stop_word=stopwords.words(\"english\")+list(punctuation)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 175,
   "metadata": {},
   "outputs": [],
   "source": [
    "#preparing input a combination of threat actor description and some other description other than threat actor\n",
    "#data_ta = pd.read_csv(r\"D:\\Threat_intel_services\\final_automation\\mitre_collected_data\\groups_data.csv\")\n",
    "data_mal = pd.read_csv(r\"D:\\Threat_intel_services\\final_automation\\mitre_collected_data\\malware_data.csv\")\n",
    "data_ta = pd.read_csv(r\"D:\\Threat_intel_services\\final_automation\\threat_actor_info_collection\\consildated.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 176,
   "metadata": {},
   "outputs": [],
   "source": [
    "# giving labels, which represent 1 to be a threat actor and other to be not as 0\n",
    "data_ta.dropna(inplace=True)\n",
    "data_ta['label']=1\n",
    "data_mal['label']=0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 177,
   "metadata": {},
   "outputs": [],
   "source": [
    "# combining of all description which will acts as input for our model\n",
    "df=data_ta[['Name','Description','label']].append(data_mal[['Name','Description','label']])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 179,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv('train_data.csv',index=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 161,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    354\n",
       "1    304\n",
       "Name: label, dtype: int64"
      ]
     },
     "execution_count": 161,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['label'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "metadata": {},
   "outputs": [],
   "source": [
    "# preparing independent variables and dependent variables\n",
    "X=list(df['Description'])\n",
    "Y=list(df['label'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 163,
   "metadata": {},
   "outputs": [],
   "source": [
    "#splitting of data in 0.25 ratio as train and test set\n",
    "sentences_train, sentences_test, y_train, y_test = train_test_split(X, Y, test_size=0.25, random_state=150)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 164,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "CountVectorizer(analyzer='word', binary=False, decode_error='strict',\n",
       "        dtype=<class 'numpy.int64'>, encoding='utf-8', input='content',\n",
       "        lowercase=True, max_df=1.0, max_features=None, min_df=1,\n",
       "        ngram_range=(1, 1), preprocessor=None,\n",
       "        stop_words=['i', 'me', 'my', 'myself', 'we', 'our', 'ours', 'ourselves', 'you', \"you're\", \"you've\", \"you'll\", \"you'd\", 'your', 'yours', 'yourself', 'yourselves', 'he', 'him', 'his', 'himself', 'she', \"she's\", 'her', 'hers', 'herself', 'it', \"it's\", 'its', 'itself', 'they', 'them', 'their', 'theirs',...'-', '.', '/', ':', ';', '<', '=', '>', '?', '@', '[', '\\\\', ']', '^', '_', '`', '{', '|', '}', '~'],\n",
       "        strip_accents=None, token_pattern='(?u)\\\\b\\\\w\\\\w+\\\\b',\n",
       "        tokenizer=None, vocabulary=None)"
      ]
     },
     "execution_count": 164,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# converting words(fitting) as vectors using count vectorizer\n",
    "vectorizer = CountVectorizer(stop_words=stop_word,lowercase = True)\n",
    "vectorizer.fit(sentences_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 165,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'machete': 1907,\n",
       " 'cyber': 821,\n",
       " 'espionage': 1139,\n",
       " 'toolset': 3221,\n",
       " 'developed': 941,\n",
       " 'spanish': 2960,\n",
       " 'speaking': 2965,\n",
       " 'group': 1449,\n",
       " 'known': 1773,\n",
       " 'el': 1066,\n",
       " 'python': 2533,\n",
       " 'based': 363,\n",
       " 'backdoor': 345,\n",
       " 'targeting': 3136,\n",
       " 'windows': 3471,\n",
       " 'machines': 1909,\n",
       " 'first': 1294,\n",
       " 'observed': 2179,\n",
       " '2010': 26,\n",
       " 'aspxspy': 281,\n",
       " 'web': 3440,\n",
       " 'shell': 2861,\n",
       " 'modified': 2033,\n",
       " 'threat': 3192,\n",
       " '3390': 52,\n",
       " 'actors': 114,\n",
       " 'create': 785,\n",
       " 'aspxtool': 282,\n",
       " 'version': 3400,\n",
       " 'boostwrite': 428,\n",
       " 'loader': 1873,\n",
       " 'crafted': 780,\n",
       " 'launched': 1810,\n",
       " 'via': 3403,\n",
       " 'abuse': 86,\n",
       " 'dll': 990,\n",
       " 'search': 2783,\n",
       " 'order': 2239,\n",
       " 'applications': 233,\n",
       " 'used': 3355,\n",
       " 'fin7': 1279,\n",
       " 'invisimole': 1692,\n",
       " 'modular': 2035,\n",
       " 'spyware': 2989,\n",
       " 'program': 2475,\n",
       " 'since': 2900,\n",
       " 'least': 1828,\n",
       " '2013': 29,\n",
       " 'two': 3277,\n",
       " 'modules': 2037,\n",
       " 'called': 488,\n",
       " 'rc2fm': 2564,\n",
       " 'rc2cl': 2563,\n",
       " 'perform': 2326,\n",
       " 'post': 2410,\n",
       " 'exploitation': 1196,\n",
       " 'activities': 111,\n",
       " 'discovered': 967,\n",
       " 'compromised': 673,\n",
       " 'victims': 3406,\n",
       " 'ukraine': 3290,\n",
       " 'russia': 2732,\n",
       " 'taidoor': 3120,\n",
       " 'malware': 1932,\n",
       " 'primarily': 2444,\n",
       " 'target': 3134,\n",
       " 'taiwanese': 3123,\n",
       " 'government': 1432,\n",
       " 'organizations': 2242,\n",
       " 'vasport': 3384,\n",
       " 'trojan': 3255,\n",
       " 'elderwood': 1068,\n",
       " 'open': 2218,\n",
       " 'hosts': 1535,\n",
       " 'downdelph': 1008,\n",
       " 'stage': 2997,\n",
       " 'downloader': 1011,\n",
       " 'written': 3505,\n",
       " 'delphi': 890,\n",
       " 'apt28': 248,\n",
       " 'rare': 2551,\n",
       " 'instances': 1648,\n",
       " '2015': 31,\n",
       " 'powruner': 2424,\n",
       " 'powershell': 2419,\n",
       " 'script': 2776,\n",
       " 'sends': 2821,\n",
       " 'receives': 2576,\n",
       " 'commands': 638,\n",
       " 'c2': 481,\n",
       " 'server': 2834,\n",
       " 'judy': 1743,\n",
       " 'auto': 325,\n",
       " 'clicking': 599,\n",
       " 'adware': 145,\n",
       " 'distributed': 986,\n",
       " 'multiple': 2073,\n",
       " 'apps': 238,\n",
       " 'google': 1428,\n",
       " 'play': 2372,\n",
       " 'store': 3034,\n",
       " 'actor': 113,\n",
       " 'targets': 3137,\n",
       " 'satellite': 2749,\n",
       " 'communications': 652,\n",
       " 'telecommunications': 3155,\n",
       " 'geospatial': 1403,\n",
       " 'imaging': 1569,\n",
       " 'defense': 875,\n",
       " 'sectors': 2799,\n",
       " 'united': 3319,\n",
       " 'states': 3012,\n",
       " 'southeast': 2950,\n",
       " 'asia': 279,\n",
       " 'purposes': 2526,\n",
       " 'oopsie': 2217,\n",
       " 'oilrig': 2203,\n",
       " 'remotely': 2631,\n",
       " 'execute': 1175,\n",
       " 'well': 3449,\n",
       " 'upload': 3337,\n",
       " 'download': 1009,\n",
       " 'files': 1272,\n",
       " 'nokki': 2144,\n",
       " 'remote': 2629,\n",
       " 'access': 92,\n",
       " 'tool': 3217,\n",
       " 'earliest': 1044,\n",
       " 'attack': 299,\n",
       " 'using': 3360,\n",
       " 'january': 1729,\n",
       " '2018': 34,\n",
       " 'significant': 2887,\n",
       " 'code': 616,\n",
       " 'overlap': 2262,\n",
       " 'konni': 1776,\n",
       " 'family': 1243,\n",
       " 'evidence': 1158,\n",
       " 'potentially': 2414,\n",
       " 'linking': 1863,\n",
       " 'apt37': 255,\n",
       " 'hardrain': 1482,\n",
       " 'variant': 3378,\n",
       " 'reportedly': 2644,\n",
       " 'north': 2150,\n",
       " 'korean': 1779,\n",
       " 'gorgon': 1430,\n",
       " 'consisting': 715,\n",
       " 'members': 1976,\n",
       " 'suspected': 3089,\n",
       " 'pakistan': 2278,\n",
       " 'connections': 706,\n",
       " 'performed': 2327,\n",
       " 'mix': 2026,\n",
       " 'criminal': 795,\n",
       " 'targeted': 3135,\n",
       " 'attacks': 304,\n",
       " 'including': 1593,\n",
       " 'campaigns': 496,\n",
       " 'kingdom': 1767,\n",
       " 'spain': 2954,\n",
       " 'njrat': 2142,\n",
       " 'rat': 2554,\n",
       " '2012': 28,\n",
       " 'middle': 1997,\n",
       " 'east': 1047,\n",
       " 'emissary': 1091,\n",
       " 'lotus': 1894,\n",
       " 'blossom': 419,\n",
       " 'shares': 2856,\n",
       " 'elise': 1081,\n",
       " 'trojans': 3257,\n",
       " 'part': 2290,\n",
       " 'referred': 2596,\n",
       " 'lstudio': 1897,\n",
       " 'chinese': 578,\n",
       " 'extensively': 1208,\n",
       " 'strategic': 3039,\n",
       " 'compromises': 674,\n",
       " 'active': 107,\n",
       " 'aerospace': 146,\n",
       " 'technology': 3150,\n",
       " 'energy': 1111,\n",
       " 'manufacturing': 1944,\n",
       " 'november': 2164,\n",
       " 'may': 1965,\n",
       " '2019': 35,\n",
       " 'senior': 2822,\n",
       " 'tibetan': 3199,\n",
       " 'groups': 1451,\n",
       " 'received': 2575,\n",
       " 'malicious': 1930,\n",
       " 'links': 1864,\n",
       " 'individually': 1608,\n",
       " 'tailored': 3121,\n",
       " 'whatsapp': 3453,\n",
       " 'text': 3173,\n",
       " 'exchanges': 1171,\n",
       " 'operators': 2231,\n",
       " 'posing': 2405,\n",
       " 'ngo': 2135,\n",
       " 'workers': 3494,\n",
       " 'journalists': 1739,\n",
       " 'fake': 1232,\n",
       " 'personas': 2339,\n",
       " 'led': 1831,\n",
       " 'designed': 922,\n",
       " 'exploit': 1195,\n",
       " 'browser': 455,\n",
       " 'vulnerabilities': 3423,\n",
       " 'install': 1643,\n",
       " 'ios': 1697,\n",
       " 'android': 207,\n",
       " 'devices': 947,\n",
       " 'cases': 521,\n",
       " 'oauth': 2172,\n",
       " 'phishing': 2347,\n",
       " 'pages': 2276,\n",
       " 'campaign': 495,\n",
       " 'carried': 516,\n",
       " 'appears': 230,\n",
       " 'single': 2904,\n",
       " 'operator': 2230,\n",
       " 'call': 487,\n",
       " 'poison': 2382,\n",
       " 'carp': 515,\n",
       " 'last': 1801,\n",
       " 'weeks': 3446,\n",
       " 'several': 2845,\n",
       " 'leaks': 1825,\n",
       " 'regarding': 2599,\n",
       " 'number': 2168,\n",
       " 'iranian': 1703,\n",
       " 'apts': 261,\n",
       " 'took': 3216,\n",
       " 'place': 2366,\n",
       " 'analyzing': 205,\n",
       " 'investigating': 1686,\n",
       " 'documents': 995,\n",
       " 'conclude': 683,\n",
       " 'authentic': 317,\n",
       " 'consequently': 708,\n",
       " 'causes': 526,\n",
       " 'considerable': 709,\n",
       " 'harm': 1484,\n",
       " 'operation': 2227,\n",
       " 'identity': 1566,\n",
       " 'behind': 382,\n",
       " 'leak': 1822,\n",
       " 'currently': 813,\n",
       " 'unknown': 3322,\n",
       " 'however': 1541,\n",
       " 'scope': 2769,\n",
       " 'quality': 2536,\n",
       " 'exposed': 1202,\n",
       " 'information': 1626,\n",
       " 'professional': 2467,\n",
       " 'highly': 1513,\n",
       " 'capable': 502,\n",
       " 'likely': 1854,\n",
       " 'hamstring': 1474,\n",
       " 'near': 2102,\n",
       " 'future': 1363,\n",
       " 'accordingly': 96,\n",
       " 'assessment': 286,\n",
       " 'minimize': 2011,\n",
       " 'risk': 2700,\n",
       " 'potential': 2413,\n",
       " 'next': 2132,\n",
       " 'months': 2051,\n",
       " 'possibly': 2409,\n",
       " 'even': 1155,\n",
       " 'year': 3518,\n",
       " 'note': 2157,\n",
       " 'posted': 2411,\n",
       " 'telegram': 3157,\n",
       " 'channels': 557,\n",
       " 'created': 786,\n",
       " 'specifically': 2973,\n",
       " 'purpose': 2525,\n",
       " 'three': 3195,\n",
       " 'main': 1918,\n",
       " 'lab': 1784,\n",
       " 'dookhtegam': 1005,\n",
       " 'pseudonym': 2510,\n",
       " 'people': 2322,\n",
       " 'whose': 3461,\n",
       " 'lips': 1866,\n",
       " 'stitched': 3029,\n",
       " 'sealed': 2782,\n",
       " 'translation': 3243,\n",
       " 'persian': 2332,\n",
       " 'channel': 556,\n",
       " 'tools': 3220,\n",
       " 'attributed': 310,\n",
       " 'leaked': 1823,\n",
       " 'webshell': 3443,\n",
       " 'inserted': 1638,\n",
       " 'technion': 3147,\n",
       " 'various': 3383,\n",
       " 'dns': 991,\n",
       " 'green': 1443,\n",
       " 'leakers': 1824,\n",
       " 'muddywatter': 2069,\n",
       " 'name': 2083,\n",
       " 'symbol': 3100,\n",
       " 'identified': 1564,\n",
       " 'movement': 2062,\n",
       " 'protests': 2495,\n",
       " 'iran': 1702,\n",
       " 'presidential': 2439,\n",
       " 'elections': 1070,\n",
       " '2009': 25,\n",
       " 'heavily': 1495,\n",
       " 'repressed': 2649,\n",
       " 'revolutionary': 2695,\n",
       " 'guards': 1455,\n",
       " 'irgc': 1705,\n",
       " 'black': 409,\n",
       " 'box': 436,\n",
       " 'unlike': 3323,\n",
       " 'previous': 2441,\n",
       " 'around': 270,\n",
       " 'long': 1886,\n",
       " 'time': 3205,\n",
       " 'friday': 1348,\n",
       " '5th': 65,\n",
       " 'dozens': 1012,\n",
       " 'confidential': 695,\n",
       " 'labeled': 1786,\n",
       " 'secret': 2795,\n",
       " 'high': 1510,\n",
       " 'confidentiality': 696,\n",
       " 'level': 1837,\n",
       " 'one': 2210,\n",
       " 'highest': 1512,\n",
       " 'top': 3223,\n",
       " 'related': 2613,\n",
       " 'activity': 112,\n",
       " 'ixeshe': 1724,\n",
       " 'fbi': 1249,\n",
       " 'issued': 1720,\n",
       " 'bulletin': 471,\n",
       " 'admitting': 132,\n",
       " 'named': 2084,\n",
       " 'advanced': 137,\n",
       " 'persistent': 2335,\n",
       " 'apt6': 260,\n",
       " 'hacked': 1461,\n",
       " 'us': 3348,\n",
       " 'computer': 676,\n",
       " 'systems': 3111,\n",
       " 'far': 1246,\n",
       " 'back': 344,\n",
       " '2011': 27,\n",
       " 'years': 3520,\n",
       " 'stole': 3030,\n",
       " 'sensitive': 2823,\n",
       " 'data': 842,\n",
       " 'alert': 169,\n",
       " 'february': 1253,\n",
       " 'went': 3450,\n",
       " 'largely': 1798,\n",
       " 'unnoticed': 3324,\n",
       " 'nearly': 2103,\n",
       " 'month': 2050,\n",
       " 'later': 1805,\n",
       " 'security': 2805,\n",
       " 'experts': 1193,\n",
       " 'shining': 2866,\n",
       " 'bright': 446,\n",
       " 'light': 1850,\n",
       " 'mysterious': 2080,\n",
       " 'little': 1868,\n",
       " 'late': 1803,\n",
       " 'welcomed': 3448,\n",
       " 'vendors': 3394,\n",
       " 'offers': 2195,\n",
       " 'chance': 550,\n",
       " 'mitigate': 2025,\n",
       " 'customers': 816,\n",
       " 'also': 189,\n",
       " 'collaborate': 621,\n",
       " 'ongoing': 2211,\n",
       " 'investigation': 1687,\n",
       " 'said': 2738,\n",
       " 'deepen': 870,\n",
       " 'desai': 913,\n",
       " 'director': 962,\n",
       " 'research': 2657,\n",
       " 'firm': 1291,\n",
       " 'zscaler': 3535,\n",
       " 'email': 1083,\n",
       " 'threatpost': 3193,\n",
       " 'details': 934,\n",
       " 'actual': 116,\n",
       " 'infected': 1617,\n",
       " 'scant': 2760,\n",
       " 'officials': 2199,\n",
       " 'knew': 1770,\n",
       " 'initial': 1628,\n",
       " 'occurred': 2187,\n",
       " 'unaware': 3296,\n",
       " 'given': 1414,\n",
       " 'nature': 2097,\n",
       " 'payload': 2311,\n",
       " 'involved': 1695,\n",
       " 'duration': 1038,\n",
       " 'compromise': 672,\n",
       " 'lateral': 1806,\n",
       " 'inside': 1639,\n",
       " 'network': 2119,\n",
       " 'exposing': 1203,\n",
       " 'critical': 797,\n",
       " 'adversaries': 138,\n",
       " 'abusing': 88,\n",
       " 'ics': 1560,\n",
       " 'dragos': 1017,\n",
       " 'inc': 1587,\n",
       " 'adversary': 139,\n",
       " 'list': 1867,\n",
       " 'sowbug': 2951,\n",
       " 'conducted': 690,\n",
       " 'south': 2949,\n",
       " 'america': 194,\n",
       " 'particularly': 2292,\n",
       " 'entities': 1122,\n",
       " 'conducting': 691,\n",
       " 'focused': 1308,\n",
       " 'foreign': 1321,\n",
       " 'policy': 2388,\n",
       " 'institutions': 1654,\n",
       " 'diplomatic': 956,\n",
       " 'seen': 2813,\n",
       " 'mounting': 2060,\n",
       " 'classic': 592,\n",
       " 'stealing': 3022,\n",
       " 'infiltrates': 1624,\n",
       " 'operate': 2223,\n",
       " 'locations': 1877,\n",
       " 'china': 576,\n",
       " 'korea': 1778,\n",
       " 'japan': 1730,\n",
       " 'linked': 1861,\n",
       " 'onion': 2213,\n",
       " 'dog': 996,\n",
       " 'military': 1999,\n",
       " 'contractors': 735,\n",
       " 'maritime': 1950,\n",
       " 'shipbuilding': 2867,\n",
       " 'others': 2254,\n",
       " 'july': 1744,\n",
       " 'singapore': 2901,\n",
       " 'largest': 1800,\n",
       " 'public': 2515,\n",
       " 'health': 1493,\n",
       " 'organization': 2241,\n",
       " 'singhealth': 2903,\n",
       " 'resulted': 2676,\n",
       " 'reported': 2643,\n",
       " 'million': 2000,\n",
       " 'patient': 2306,\n",
       " 'records': 2585,\n",
       " 'stolen': 3031,\n",
       " 'nothing': 2159,\n",
       " 'responsible': 2671,\n",
       " 'symantec': 3099,\n",
       " 'researchers': 2659,\n",
       " 'whitefly': 3459,\n",
       " 'operating': 2226,\n",
       " '2017': 33,\n",
       " 'mostly': 2055,\n",
       " 'across': 102,\n",
       " 'wide': 3464,\n",
       " 'variety': 3382,\n",
       " 'interested': 1667,\n",
       " 'large': 1797,\n",
       " 'amounts': 200,\n",
       " 'nanhaishu': 2087,\n",
       " 'jscript': 1741,\n",
       " 'leviathan': 1843,\n",
       " 'private': 2451,\n",
       " 'sector': 2797,\n",
       " 'relations': 2615,\n",
       " 'sea': 2780,\n",
       " 'dispute': 977,\n",
       " 'axiom': 339,\n",
       " 'associated': 288,\n",
       " 'smn': 2927,\n",
       " 'though': 3188,\n",
       " 'winnti': 3476,\n",
       " 'use': 3354,\n",
       " 'appear': 227,\n",
       " 'distinct': 982,\n",
       " 'differences': 948,\n",
       " 'reporting': 2645,\n",
       " 'ttps': 3264,\n",
       " 'grouping': 1450,\n",
       " 'actually': 117,\n",
       " 'rather': 2557,\n",
       " 'discrete': 970,\n",
       " 'entity': 1124,\n",
       " 'kaspersky': 1750,\n",
       " 'describe': 914,\n",
       " 'attacking': 303,\n",
       " 'companies': 656,\n",
       " 'online': 2215,\n",
       " 'video': 3407,\n",
       " 'game': 1371,\n",
       " 'industry': 1613,\n",
       " 'still': 3028,\n",
       " 'objectives': 2176,\n",
       " 'digital': 952,\n",
       " 'certificates': 543,\n",
       " 'signed': 2886,\n",
       " 'legitimate': 1834,\n",
       " 'software': 2938,\n",
       " 'addition': 123,\n",
       " 'intellectual': 1658,\n",
       " 'property': 2490,\n",
       " 'theft': 3179,\n",
       " 'source': 2946,\n",
       " 'projects': 2481,\n",
       " 'majority': 1925,\n",
       " 'administration': 130,\n",
       " '2014': 30,\n",
       " 'evolved': 1163,\n",
       " 'capabilities': 500,\n",
       " 'involving': 1696,\n",
       " 'themes': 3181,\n",
       " 'pro': 2454,\n",
       " 'islamist': 1714,\n",
       " 'generally': 1391,\n",
       " 'conducts': 692,\n",
       " 'motivated': 2056,\n",
       " 'real': 2572,\n",
       " 'world': 3498,\n",
       " 'events': 1156,\n",
       " 'believe': 386,\n",
       " 'muslim': 2076,\n",
       " 'faith': 1231,\n",
       " 'wronged': 3506,\n",
       " 'involve': 1694,\n",
       " 'website': 3444,\n",
       " 'defacements': 872,\n",
       " 'develop': 940,\n",
       " 'refers': 2597,\n",
       " 'fallaga': 1238,\n",
       " 'simply': 2898,\n",
       " 'fork': 1322,\n",
       " 'popular': 2395,\n",
       " 'amongst': 197,\n",
       " 'hackers': 1463,\n",
       " 'africa': 155,\n",
       " 'region': 2603,\n",
       " 'pngdowner': 2379,\n",
       " 'putter': 2530,\n",
       " 'panda': 2283,\n",
       " 'simple': 2896,\n",
       " 'limited': 1856,\n",
       " 'functionality': 1357,\n",
       " 'persistence': 2334,\n",
       " 'mechanism': 1968,\n",
       " 'suggesting': 3068,\n",
       " 'utility': 3363,\n",
       " 'apt12': 243,\n",
       " 'media': 1970,\n",
       " 'outlets': 2258,\n",
       " 'tech': 3144,\n",
       " 'governments': 1434,\n",
       " 'gooligan': 1429,\n",
       " 'runs': 2731,\n",
       " 'privilege': 2452,\n",
       " 'escalation': 1135,\n",
       " 'exploits': 1199,\n",
       " 'uses': 3359,\n",
       " 'escalated': 1133,\n",
       " 'privileges': 2453,\n",
       " 'steal': 3019,\n",
       " 'authentication': 318,\n",
       " 'tokens': 3214,\n",
       " 'many': 1945,\n",
       " 'described': 915,\n",
       " 'ghost': 1409,\n",
       " 'push': 2528,\n",
       " 'scarlet': 2762,\n",
       " 'mimic': 2002,\n",
       " 'minority': 2018,\n",
       " 'rights': 2696,\n",
       " 'activists': 110,\n",
       " 'directly': 961,\n",
       " 'motivations': 2058,\n",
       " 'ip': 1699,\n",
       " 'addresses': 127,\n",
       " 'concluded': 684,\n",
       " 'apt': 240,\n",
       " 'began': 373,\n",
       " 'four': 1334,\n",
       " 'ago': 161,\n",
       " 'pattern': 2307,\n",
       " 'suggests': 3069,\n",
       " 'primary': 2445,\n",
       " 'mission': 2022,\n",
       " 'gather': 1381,\n",
       " 'derived': 911,\n",
       " 'supports': 3080,\n",
       " 'similar': 2893,\n",
       " 'stated': 3011,\n",
       " 'position': 2406,\n",
       " 'relation': 2614,\n",
       " 'attribute': 309,\n",
       " 'uyghur': 3367,\n",
       " 'community': 654,\n",
       " 'uyghurs': 3368,\n",
       " 'turkic': 3268,\n",
       " 'residing': 2663,\n",
       " 'northwest': 2152,\n",
       " 'sophisticated': 2943,\n",
       " 'past': 2302,\n",
       " 'decade': 858,\n",
       " 'history': 1519,\n",
       " 'strained': 3036,\n",
       " 'relationships': 2617,\n",
       " 'republic': 2652,\n",
       " 'prc': 2426,\n",
       " 'india': 1599,\n",
       " 'tracking': 3230,\n",
       " 'activist': 109,\n",
       " 'terrorist': 3170,\n",
       " 'know': 1771,\n",
       " 'precise': 2429,\n",
       " 'align': 172,\n",
       " 'patterns': 2308,\n",
       " 'bootrash': 430,\n",
       " 'bootkit': 429,\n",
       " 'financial': 1282,\n",
       " 'unit': 3318,\n",
       " '42': 61,\n",
       " 'subaat': 3052,\n",
       " 'attacker': 301,\n",
       " 'recently': 2578,\n",
       " 'drew': 1020,\n",
       " 'attention': 307,\n",
       " 'due': 1032,\n",
       " 'renewed': 2636,\n",
       " 'monitoring': 2047,\n",
       " 'included': 1591,\n",
       " 'realizing': 2573,\n",
       " 'larger': 1799,\n",
       " 'crew': 792,\n",
       " 'individuals': 1609,\n",
       " 'carrying': 519,\n",
       " 'worldwide': 3500,\n",
       " 'governmental': 1433,\n",
       " 'technical': 3145,\n",
       " 'analysis': 201,\n",
       " 'attribution': 312,\n",
       " 'already': 188,\n",
       " 'depicted': 902,\n",
       " '360': 53,\n",
       " 'tuisec': 3265,\n",
       " 'found': 1330,\n",
       " 'interesting': 1668,\n",
       " 'attackers': 302,\n",
       " 'calling': 489,\n",
       " 'apt16': 244,\n",
       " 'spearphishing': 2968,\n",
       " 'japanese': 1731,\n",
       " 'sandworm': 2748,\n",
       " 'team': 3142,\n",
       " 'russian': 2733,\n",
       " 'operated': 2224,\n",
       " 'approximately': 237,\n",
       " 'consists': 716,\n",
       " 'hacktivists': 1467,\n",
       " 'mainly': 1919,\n",
       " 'ukrainian': 3291,\n",
       " 'industrial': 1611,\n",
       " 'control': 738,\n",
       " 'scada': 2756,\n",
       " 'emotet': 1092,\n",
       " 'variants': 3379,\n",
       " 'trickbot': 3249,\n",
       " 'icedid': 1558,\n",
       " 'emerged': 1087,\n",
       " 'june': 1745,\n",
       " 'banking': 359,\n",
       " 'bondupdater': 426,\n",
       " 'eastern': 1048,\n",
       " 'updated': 3333,\n",
       " 'august': 314,\n",
       " 'emails': 1084,\n",
       " 'kazuar': 1752,\n",
       " 'fully': 1355,\n",
       " 'featured': 1251,\n",
       " 'multi': 2070,\n",
       " 'platform': 2369,\n",
       " 'microsoft': 1995,\n",
       " 'net': 2114,\n",
       " 'framework': 1337,\n",
       " 'rotexy': 2716,\n",
       " 'originally': 2246,\n",
       " 'sms': 2930,\n",
       " 'spotted': 2980,\n",
       " 'october': 2191,\n",
       " 'contain': 722,\n",
       " 'features': 1252,\n",
       " 'ransomware': 2549,\n",
       " 'ursnif': 3346,\n",
       " 'gozi': 1435,\n",
       " 'spread': 2981,\n",
       " 'automated': 328,\n",
       " 'kits': 1768,\n",
       " 'attachments': 298,\n",
       " 'include': 1590,\n",
       " 'components': 668,\n",
       " 'backdoors': 346,\n",
       " 'file': 1271,\n",
       " 'injectors': 1634,\n",
       " 'etc': 1146,\n",
       " 'behaviors': 380,\n",
       " 'blackgear': 411,\n",
       " 'users': 3358,\n",
       " 'taiwan': 3122,\n",
       " 'papers': 2285,\n",
       " 'talks': 3128,\n",
       " 'released': 2621,\n",
       " 'covering': 773,\n",
       " 'elirks': 1080,\n",
       " 'blogs': 418,\n",
       " 'microblogging': 1990,\n",
       " 'services': 2839,\n",
       " 'hide': 1509,\n",
       " 'location': 1876,\n",
       " 'command': 637,\n",
       " 'servers': 2835,\n",
       " 'allows': 182,\n",
       " 'change': 551,\n",
       " 'quickly': 2538,\n",
       " 'changing': 555,\n",
       " 'posts': 2412,\n",
       " 'like': 1853,\n",
       " 'indicates': 1602,\n",
       " 'started': 3006,\n",
       " 'things': 3185,\n",
       " 'conclusion': 685,\n",
       " 'infection': 1619,\n",
       " 'routines': 2720,\n",
       " 'secondly': 2794,\n",
       " 'blogging': 417,\n",
       " 'sites': 2907,\n",
       " 'zoopark': 3533,\n",
       " 'cyberespionage': 826,\n",
       " 'focusing': 1310,\n",
       " 'infect': 1616,\n",
       " 'generations': 1395,\n",
       " 'label': 1785,\n",
       " 'v1': 3369,\n",
       " 'v4': 3371,\n",
       " 'recent': 2577,\n",
       " 'deployed': 904,\n",
       " 'comnie': 655,\n",
       " '3para': 57,\n",
       " 'programmed': 2476,\n",
       " 'usbstealer': 3352,\n",
       " '2005': 21,\n",
       " 'extract': 1216,\n",
       " 'air': 166,\n",
       " 'gapped': 1377,\n",
       " 'networks': 2121,\n",
       " 'capability': 501,\n",
       " 'communicate': 649,\n",
       " 'internet': 1676,\n",
       " 'conjunction': 701,\n",
       " 'advstoreshell': 144,\n",
       " 'wekby': 3447,\n",
       " 'palo': 2282,\n",
       " 'alto': 191,\n",
       " 'report': 2642,\n",
       " 'industries': 1612,\n",
       " 'healthcare': 1494,\n",
       " 'leverage': 1839,\n",
       " 'shortly': 2871,\n",
       " 'available': 332,\n",
       " 'case': 520,\n",
       " 'hackingteams': 1465,\n",
       " 'flash': 1301,\n",
       " 'zero': 3528,\n",
       " 'day': 848,\n",
       " 'hammertoss': 1473,\n",
       " 'apt29': 249,\n",
       " 'dropping': 1029,\n",
       " 'elephant': 1078,\n",
       " 'chinastrats': 577,\n",
       " 'patchwork': 2305,\n",
       " 'relatively': 2618,\n",
       " 'new': 2124,\n",
       " 'profile': 2470,\n",
       " 'economic': 1050,\n",
       " 'custom': 814,\n",
       " 'set': 2841,\n",
       " 'way': 3436,\n",
       " 'caught': 524,\n",
       " 'spear': 2967,\n",
       " 'watering': 3434,\n",
       " 'hole': 1522,\n",
       " 'nidiran': 2137,\n",
       " 'suckfly': 3064,\n",
       " 'delivered': 885,\n",
       " 'lojax': 1884,\n",
       " 'uefi': 3286,\n",
       " 'rootkit': 2713,\n",
       " 'persist': 2333,\n",
       " 'bubblewrap': 461,\n",
       " 'full': 1354,\n",
       " 'second': 2792,\n",
       " 'admin': 128,\n",
       " '338': 51,\n",
       " 'run': 2728,\n",
       " 'system': 3109,\n",
       " 'boots': 431,\n",
       " 'includes': 1592,\n",
       " 'check': 567,\n",
       " 'register': 2606,\n",
       " 'plug': 2375,\n",
       " 'ins': 1637,\n",
       " 'enhance': 1116,\n",
       " 'cozycar': 776,\n",
       " 'component': 667,\n",
       " 'instructed': 1655,\n",
       " 'different': 949,\n",
       " 'seasharpee': 2787,\n",
       " 'apt34': 254,\n",
       " 'androidos_anserver': 209,\n",
       " 'unique': 3317,\n",
       " 'encrypted': 1106,\n",
       " 'content': 726,\n",
       " 'within': 3484,\n",
       " 'blog': 415,\n",
       " 'site': 2906,\n",
       " 'griffon': 1447,\n",
       " 'javascript': 1732,\n",
       " 'claimed': 591,\n",
       " 'hermes': 1505,\n",
       " 'stardust': 3004,\n",
       " 'chollima': 579,\n",
       " 'lazarus': 1816,\n",
       " 'executed': 1176,\n",
       " 'host': 1531,\n",
       " 'swift': 3094,\n",
       " 'feib': 1259,\n",
       " 'political': 2389,\n",
       " 'acts': 115,\n",
       " 'support': 3077,\n",
       " 'operations': 2229,\n",
       " 'affiliated': 152,\n",
       " 'intelligence': 1659,\n",
       " 'believed': 387,\n",
       " '17': 13,\n",
       " 'mirage': 2019,\n",
       " 'share': 2852,\n",
       " 'infrastructure': 1627,\n",
       " 'aurora': 315,\n",
       " 'thai': 3176,\n",
       " 'language': 1793,\n",
       " 'news': 2129,\n",
       " 'websites': 3445,\n",
       " 'apt33': 253,\n",
       " 'saudi': 2751,\n",
       " 'arabia': 263,\n",
       " 'particular': 2291,\n",
       " 'interest': 1666,\n",
       " 'aviation': 334,\n",
       " 'reveals': 2689,\n",
       " 'assess': 284,\n",
       " 'works': 3496,\n",
       " 'behest': 381,\n",
       " 'discusses': 972,\n",
       " 'state': 3010,\n",
       " 'sponsored': 2977,\n",
       " 'manipulating': 1940,\n",
       " 'incident': 1588,\n",
       " 'national': 2091,\n",
       " 'want': 3428,\n",
       " 'overstate': 2265,\n",
       " 'consequences': 707,\n",
       " 'specific': 2972,\n",
       " 'concerned': 682,\n",
       " 'success': 3060,\n",
       " 'lead': 1817,\n",
       " 'broadly': 450,\n",
       " 'global': 1415,\n",
       " 'foundational': 1332,\n",
       " 'supporting': 3079,\n",
       " 'undermine': 3304,\n",
       " 'trust': 3260,\n",
       " 'stability': 2995,\n",
       " 'whole': 3460,\n",
       " 'drives': 1023,\n",
       " 'economy': 1051,\n",
       " 'nations': 2093,\n",
       " 'avoid': 335,\n",
       " 'work': 3492,\n",
       " 'together': 3213,\n",
       " 'establish': 1140,\n",
       " 'accepted': 91,\n",
       " 'norm': 2149,\n",
       " 'limits': 1857,\n",
       " 'cooperate': 746,\n",
       " 'pursuing': 2527,\n",
       " 'act': 103,\n",
       " 'irresponsibly': 1708,\n",
       " 'pegasus': 2315,\n",
       " 'nso': 2166,\n",
       " 'tracked': 3229,\n",
       " 'separately': 2827,\n",
       " 'molerats': 2038,\n",
       " 'politically': 2390,\n",
       " 'europe': 1150,\n",
       " 'israeli': 1717,\n",
       " 'grabbed': 1438,\n",
       " 'temporarily': 3162,\n",
       " 'cut': 818,\n",
       " 'entire': 1121,\n",
       " 'police': 2386,\n",
       " 'force': 1318,\n",
       " 'banned': 362,\n",
       " 'usb': 3351,\n",
       " 'memory': 1978,\n",
       " 'sticks': 3027,\n",
       " 'subsequently': 3058,\n",
       " 'broader': 449,\n",
       " 'yearlong': 3519,\n",
       " 'israelis': 1718,\n",
       " 'palestinians': 2280,\n",
       " 'uk': 3289,\n",
       " 'revealed': 2688,\n",
       " 'connection': 705,\n",
       " 'gaza': 1385,\n",
       " 'refer': 2594,\n",
       " 'greenbug': 1444,\n",
       " 'range': 2546,\n",
       " 'investment': 1690,\n",
       " 'education': 1055,\n",
       " 'apt38': 256,\n",
       " 'financially': 1283,\n",
       " 'backed': 347,\n",
       " 'regime': 2600,\n",
       " 'banks': 360,\n",
       " '16': 12,\n",
       " '13': 8,\n",
       " 'countries': 766,\n",
       " 'definitions': 877,\n",
       " 'encompass': 1103,\n",
       " 'broad': 448,\n",
       " 'track': 3228,\n",
       " 'clusters': 610,\n",
       " 'bluenoroff': 422,\n",
       " 'names': 2085,\n",
       " 'xbash': 3511,\n",
       " 'linux': 1865,\n",
       " 'tied': 3202,\n",
       " 'iron': 1707,\n",
       " 'converted': 744,\n",
       " 'self': 2817,\n",
       " 'contained': 723,\n",
       " 'elf': 1079,\n",
       " 'executable': 1174,\n",
       " 'pyinstaller': 2532,\n",
       " 'h1n1': 1459,\n",
       " 'vba': 3388,\n",
       " 'macros': 1912,\n",
       " 'although': 190,\n",
       " 'initially': 1629,\n",
       " 'electric': 1072,\n",
       " 'power': 2416,\n",
       " 'looking': 1888,\n",
       " 'muddywater': 2068,\n",
       " 'european': 1151,\n",
       " 'american': 195,\n",
       " 'oil': 2202,\n",
       " 'previously': 2442,\n",
       " 'surrounding': 3084,\n",
       " 'beyond': 394,\n",
       " 'usa': 3349,\n",
       " 'characterized': 561,\n",
       " 'slowly': 2923,\n",
       " 'evolving': 1164,\n",
       " 'powerstats': 2422,\n",
       " 'despite': 925,\n",
       " 'scrutiny': 2779,\n",
       " 'reports': 2646,\n",
       " 'continues': 731,\n",
       " 'incremental': 1597,\n",
       " 'changes': 554,\n",
       " 'techniques': 3148,\n",
       " 'mcafee': 1966,\n",
       " 'labs': 1789,\n",
       " 'nuclear': 2167,\n",
       " 'sharpshooter': 2858,\n",
       " ...}"
      ]
     },
     "execution_count": 165,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vectorizer.vocabulary_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 169,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "140"
      ]
     },
     "execution_count": 169,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "u['adopters']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "metadata": {},
   "outputs": [],
   "source": [
    "u=vectorizer.vocabulary_\n",
    "a = sorted(u.items(), key=lambda x: x[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 155,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "3604"
      ]
     },
     "execution_count": 155,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(u)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 168,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('000', 0),\n",
       " ('0110', 1),\n",
       " ('048', 2),\n",
       " ('069', 3),\n",
       " ('0798', 4),\n",
       " ('10', 5),\n",
       " ('103', 6),\n",
       " ('11882', 7),\n",
       " ('128', 8),\n",
       " ('13', 9),\n",
       " ('1314', 10),\n",
       " ('14', 11),\n",
       " ('15', 12),\n",
       " ('150', 13),\n",
       " ('16', 14),\n",
       " ('17', 15),\n",
       " ('1701', 16),\n",
       " ('17215', 17),\n",
       " ('1mission', 18),\n",
       " ('20', 19),\n",
       " ('200', 20),\n",
       " ('2002', 21),\n",
       " ('2003', 22),\n",
       " ('2004', 23),\n",
       " ('2005', 24),\n",
       " ('2007', 25),\n",
       " ('2008', 26),\n",
       " ('2009', 27),\n",
       " ('2010', 28),\n",
       " ('2011', 29),\n",
       " ('2012', 30),\n",
       " ('2013', 31),\n",
       " ('2014', 32),\n",
       " ('2015', 33),\n",
       " ('2016', 34),\n",
       " ('2017', 35),\n",
       " ('2018', 36),\n",
       " ('2019', 37),\n",
       " ('2020', 38),\n",
       " ('21', 39),\n",
       " ('2223', 40),\n",
       " ('25', 41),\n",
       " ('250', 42),\n",
       " ('26', 43),\n",
       " ('27', 44),\n",
       " ('2889', 45),\n",
       " ('295', 46),\n",
       " ('2nd', 47),\n",
       " ('30', 48),\n",
       " ('300', 49),\n",
       " ('3012', 50),\n",
       " ('31', 51),\n",
       " ('338', 52),\n",
       " ('3390', 53),\n",
       " ('35', 54),\n",
       " ('36', 55),\n",
       " ('360', 56),\n",
       " ('38722', 57),\n",
       " ('39', 58),\n",
       " ('3para', 59),\n",
       " ('3rd', 60),\n",
       " ('40', 61),\n",
       " ('400gb', 62),\n",
       " ('42', 63),\n",
       " ('43', 64),\n",
       " ('45', 65),\n",
       " ('509', 66),\n",
       " ('52', 67),\n",
       " ('53', 68),\n",
       " ('5th', 69),\n",
       " ('60', 70),\n",
       " ('600', 71),\n",
       " ('61398', 72),\n",
       " ('61398部队', 73),\n",
       " ('6352', 74),\n",
       " ('64', 75),\n",
       " ('670', 76),\n",
       " ('70', 77),\n",
       " ('701', 78),\n",
       " ('705', 79),\n",
       " ('761', 80),\n",
       " ('80', 81),\n",
       " ('800', 82),\n",
       " ('8361', 83),\n",
       " ('85', 84),\n",
       " ('8589', 85),\n",
       " ('8611', 86),\n",
       " ('893', 87),\n",
       " ('90', 88),\n",
       " ('9002', 89),\n",
       " ('98', 90),\n",
       " ('ability', 91),\n",
       " ('able', 92),\n",
       " ('abrupt', 93),\n",
       " ('abuse', 94),\n",
       " ('abuses', 95),\n",
       " ('abusing', 96),\n",
       " ('academic', 97),\n",
       " ('academics', 98),\n",
       " ('access', 99),\n",
       " ('accesses', 100),\n",
       " ('according', 101),\n",
       " ('accordingly', 102),\n",
       " ('account', 103),\n",
       " ('accounts', 104),\n",
       " ('achieve', 105),\n",
       " ('achieved', 106),\n",
       " ('acknowledged', 107),\n",
       " ('across', 108),\n",
       " ('act', 109),\n",
       " ('actions', 110),\n",
       " ('activates', 111),\n",
       " ('activating', 112),\n",
       " ('active', 113),\n",
       " ('actively', 114),\n",
       " ('activist', 115),\n",
       " ('activists', 116),\n",
       " ('activities', 117),\n",
       " ('activity', 118),\n",
       " ('actor', 119),\n",
       " ('actors', 120),\n",
       " ('acts', 121),\n",
       " ('actual', 122),\n",
       " ('ad', 123),\n",
       " ('adapter', 124),\n",
       " ('adapters', 125),\n",
       " ('adbupd', 126),\n",
       " ('added', 127),\n",
       " ('addition', 128),\n",
       " ('additional', 129),\n",
       " ('additionally', 130),\n",
       " ('address', 131),\n",
       " ('addresses', 132),\n",
       " ('admin', 133),\n",
       " ('administered', 134),\n",
       " ('administration', 135),\n",
       " ('administrator', 136),\n",
       " ('admitting', 137),\n",
       " ('adobe', 138),\n",
       " ('adopted', 139),\n",
       " ('adopters', 140),\n",
       " ('ads', 141),\n",
       " ('adult', 142),\n",
       " ('adups', 143),\n",
       " ('advanced', 144),\n",
       " ('adversaries', 145),\n",
       " ('adversary', 146),\n",
       " ('advertised', 147),\n",
       " ('advertisements', 148),\n",
       " ('advertising', 149),\n",
       " ('advstoreshell', 150),\n",
       " ('adware', 151),\n",
       " ('aerospace', 152),\n",
       " ('aes', 153),\n",
       " ('affair', 154),\n",
       " ('affairs', 155),\n",
       " ('affect', 156),\n",
       " ('affected', 157),\n",
       " ('affecting', 158),\n",
       " ('affects', 159),\n",
       " ('affiliated', 160),\n",
       " ('affiliates', 161),\n",
       " ('afghanistan', 162),\n",
       " ('afghanr', 163),\n",
       " ('aforementioned', 164),\n",
       " ('africa', 165),\n",
       " ('agencies', 166),\n",
       " ('agency', 167),\n",
       " ('agent', 168),\n",
       " ('agents', 169),\n",
       " ('aggressively', 170),\n",
       " ('ago', 171),\n",
       " ('agreement', 172),\n",
       " ('ahead', 173),\n",
       " ('aid', 174),\n",
       " ('aimed', 175),\n",
       " ('air', 176),\n",
       " ('airline', 177),\n",
       " ('aka', 178),\n",
       " ('al', 179),\n",
       " ('alert', 180),\n",
       " ('algorithms', 181),\n",
       " ('aliases', 182),\n",
       " ('align', 183),\n",
       " ('aligned', 184),\n",
       " ('allanite', 185),\n",
       " ('allegation', 186),\n",
       " ('alleged', 187),\n",
       " ('allegedly', 188),\n",
       " ('allegiance', 189),\n",
       " ('alliance', 190),\n",
       " ('allow', 191),\n",
       " ('allowed', 192),\n",
       " ('allowing', 193),\n",
       " ('allows', 194),\n",
       " ('allwinner', 195),\n",
       " ('almost', 196),\n",
       " ('alone', 197),\n",
       " ('along', 198),\n",
       " ('already', 199),\n",
       " ('also', 200),\n",
       " ('although', 201),\n",
       " ('alto', 202),\n",
       " ('always', 203),\n",
       " ('ambassador', 204),\n",
       " ('america', 205),\n",
       " ('american', 206),\n",
       " ('among', 207),\n",
       " ('amongst', 208),\n",
       " ('amount', 209),\n",
       " ('amounted', 210),\n",
       " ('amounts', 211),\n",
       " ('analysing', 212),\n",
       " ('analysis', 213),\n",
       " ('analysts', 214),\n",
       " ('analyzed', 215),\n",
       " ('analyzes', 216),\n",
       " ('analyzing', 217),\n",
       " ('anchor', 218),\n",
       " ('android', 219),\n",
       " ('androidos', 220),\n",
       " ('androidos_anserver', 221),\n",
       " ('androrat', 222),\n",
       " ('angry', 223),\n",
       " ('animal', 224),\n",
       " ('announced', 225),\n",
       " ('anonymous', 226),\n",
       " ('anonymously', 227),\n",
       " ('another', 228),\n",
       " ('anthem', 229),\n",
       " ('anthropoid', 230),\n",
       " ('anti', 231),\n",
       " ('antivirus', 232),\n",
       " ('anymore', 233),\n",
       " ('ao', 234),\n",
       " ('apache', 235),\n",
       " ('api', 236),\n",
       " ('apis', 237),\n",
       " ('app', 238),\n",
       " ('apparent', 239),\n",
       " ('apparently', 240),\n",
       " ('appear', 241),\n",
       " ('appearance', 242),\n",
       " ('appeared', 243),\n",
       " ('appears', 244),\n",
       " ('apple', 245),\n",
       " ('application', 246),\n",
       " ('applications', 247),\n",
       " ('approach', 248),\n",
       " ('appropriate', 249),\n",
       " ('appropriated', 250),\n",
       " ('approximately', 251),\n",
       " ('apps', 252),\n",
       " ('april', 253),\n",
       " ('apt', 254),\n",
       " ('apt0lstu', 255),\n",
       " ('apt1', 256),\n",
       " ('apt10', 257),\n",
       " ('apt12', 258),\n",
       " ('apt16', 259),\n",
       " ('apt17', 260),\n",
       " ('apt18', 261),\n",
       " ('apt19', 262),\n",
       " ('apt20', 263),\n",
       " ('apt27', 264),\n",
       " ('apt28', 265),\n",
       " ('apt29', 266),\n",
       " ('apt3', 267),\n",
       " ('apt30', 268),\n",
       " ('apt31', 269),\n",
       " ('apt32', 270),\n",
       " ('apt33', 271),\n",
       " ('apt34', 272),\n",
       " ('apt35', 273),\n",
       " ('apt37', 274),\n",
       " ('apt38', 275),\n",
       " ('apt41', 276),\n",
       " ('apt5', 277),\n",
       " ('apt6', 278),\n",
       " ('apts', 279),\n",
       " ('arab', 280),\n",
       " ('arabia', 281),\n",
       " ('arabian', 282),\n",
       " ('arbitrary', 283),\n",
       " ('arbor', 284),\n",
       " ('architecture', 285),\n",
       " ('archive', 286),\n",
       " ('area', 287),\n",
       " ('argentina', 288),\n",
       " ('armenia', 289),\n",
       " ('army', 290),\n",
       " ('around', 291),\n",
       " ('arrest', 292),\n",
       " ('arrested', 293),\n",
       " ('arsenal', 294),\n",
       " ('article', 295),\n",
       " ('articles', 296),\n",
       " ('artifacts', 297),\n",
       " ('ascertain', 298),\n",
       " ('asert', 299),\n",
       " ('asia', 300),\n",
       " ('asian', 301),\n",
       " ('aspxspy', 302),\n",
       " ('aspxtool', 303),\n",
       " ('assad', 304),\n",
       " ('assess', 305),\n",
       " ('assessed', 306),\n",
       " ('assesses', 307),\n",
       " ('assessment', 308),\n",
       " ('assets', 309),\n",
       " ('assigned', 310),\n",
       " ('assigning', 311),\n",
       " ('associated', 312),\n",
       " ('associations', 313),\n",
       " ('astaroth', 314),\n",
       " ('asus', 315),\n",
       " ('atlas', 316),\n",
       " ('atm', 317),\n",
       " ('atms', 318),\n",
       " ('attach', 319),\n",
       " ('attached', 320),\n",
       " ('attachment', 321),\n",
       " ('attachments', 322),\n",
       " ('attack', 323),\n",
       " ('attacked', 324),\n",
       " ('attacker', 325),\n",
       " ('attackers', 326),\n",
       " ('attacking', 327),\n",
       " ('attacks', 328),\n",
       " ('attempt', 329),\n",
       " ('attempted', 330),\n",
       " ('attempts', 331),\n",
       " ('attention', 332),\n",
       " ('attorney', 333),\n",
       " ('attribute', 334),\n",
       " ('attributed', 335),\n",
       " ('attributes', 336),\n",
       " ('attribution', 337),\n",
       " ('august', 338),\n",
       " ('aurora', 339),\n",
       " ('australia', 340),\n",
       " ('austria', 341),\n",
       " ('authentic', 342),\n",
       " ('authentication', 343),\n",
       " ('author', 344),\n",
       " ('authored', 345),\n",
       " ('authoritarian', 346),\n",
       " ('authorized', 347),\n",
       " ('authors', 348),\n",
       " ('auto', 349),\n",
       " ('autoit', 350),\n",
       " ('automate', 351),\n",
       " ('automated', 352),\n",
       " ('automation', 353),\n",
       " ('automotive', 354),\n",
       " ('av', 355),\n",
       " ('available', 356),\n",
       " ('average', 357),\n",
       " ('aviation', 358),\n",
       " ('avoid', 359),\n",
       " ('aware', 360),\n",
       " ('awareness', 361),\n",
       " ('aws', 362),\n",
       " ('axiom', 363),\n",
       " ('ayyıldız', 364),\n",
       " ('azerbaijan', 365),\n",
       " ('azorult', 366),\n",
       " ('babyshark', 367),\n",
       " ('back', 368),\n",
       " ('backdoor', 369),\n",
       " ('backdoors', 370),\n",
       " ('backdrop', 371),\n",
       " ('backed', 372),\n",
       " ('background', 373),\n",
       " ('backup', 374),\n",
       " ('badbullzvenom', 375),\n",
       " ('badnews', 376),\n",
       " ('badpatch', 377),\n",
       " ('bahamut', 378),\n",
       " ('bait', 379),\n",
       " ('baltimore', 380),\n",
       " ('bank', 381),\n",
       " ('banking', 382),\n",
       " ('banks', 383),\n",
       " ('bankshot', 384),\n",
       " ('banned', 385),\n",
       " ('base', 386),\n",
       " ('based', 387),\n",
       " ('bases', 388),\n",
       " ('bash', 389),\n",
       " ('bashar', 390),\n",
       " ('basic', 391),\n",
       " ('basis', 392),\n",
       " ('battling', 393),\n",
       " ('bbsrat', 394),\n",
       " ('bcrypt', 395),\n",
       " ('beacon', 396),\n",
       " ('bear', 397),\n",
       " ('became', 398),\n",
       " ('become', 399),\n",
       " ('began', 400),\n",
       " ('beginning', 401),\n",
       " ('begins', 402),\n",
       " ('behalf', 403),\n",
       " ('behavior', 404),\n",
       " ('behaviors', 405),\n",
       " ('behest', 406),\n",
       " ('behind', 407),\n",
       " ('beirut', 408),\n",
       " ('belarus', 409),\n",
       " ('belgium', 410),\n",
       " ('believe', 411),\n",
       " ('believed', 412),\n",
       " ('belizean', 413),\n",
       " ('belong', 414),\n",
       " ('belonging', 415),\n",
       " ('best', 416),\n",
       " ('beyond', 417),\n",
       " ('bgh', 418),\n",
       " ('bidder', 419),\n",
       " ('big', 420),\n",
       " ('billion', 421),\n",
       " ('binaries', 422),\n",
       " ('binary', 423),\n",
       " ('biography', 424),\n",
       " ('bios', 425),\n",
       " ('biotechnology', 426),\n",
       " ('bisonal', 427),\n",
       " ('bit', 428),\n",
       " ('bitcoin', 429),\n",
       " ('bitpaymer', 430),\n",
       " ('bits', 431),\n",
       " ('black', 432),\n",
       " ('blackenergy', 433),\n",
       " ('blackgear', 434),\n",
       " ('blackhat', 435),\n",
       " ('blackmail', 436),\n",
       " ('blackoasis', 437),\n",
       " ('blank', 438),\n",
       " ('blind', 439),\n",
       " ('bloc', 440),\n",
       " ('blockbuster', 441),\n",
       " ('blog', 442),\n",
       " ('bloggers', 443),\n",
       " ('blogging', 444),\n",
       " ('blogs', 445),\n",
       " ('blossom', 446),\n",
       " ('blu', 447),\n",
       " ('blue', 448),\n",
       " ('bluenoroff', 449),\n",
       " ('boire', 450),\n",
       " ('bokbok', 451),\n",
       " ('bokbot', 452),\n",
       " ('bone', 453),\n",
       " ('boostwrite', 454),\n",
       " ('bootkit', 455),\n",
       " ('bootrash', 456),\n",
       " ('boots', 457),\n",
       " ('boss', 458),\n",
       " ('bot', 459),\n",
       " ('botnet', 460),\n",
       " ('botnets', 461),\n",
       " ('boundaries', 462),\n",
       " ('box', 463),\n",
       " ('braintest', 464),\n",
       " ('brave', 465),\n",
       " ('brazil', 466),\n",
       " ('breach', 467),\n",
       " ('breached', 468),\n",
       " ('breaches', 469),\n",
       " ('break', 470),\n",
       " ('briba', 471),\n",
       " ('bright', 472),\n",
       " ('bringing', 473),\n",
       " ('broad', 474),\n",
       " ('broader', 475),\n",
       " ('broadly', 476),\n",
       " ('brokers', 477),\n",
       " ('bronze', 478),\n",
       " ('brought', 479),\n",
       " ('brown', 480),\n",
       " ('browser', 481),\n",
       " ('brute', 482),\n",
       " ('bs2005', 483),\n",
       " ('btc', 484),\n",
       " ('btz', 485),\n",
       " ('bubblewrap', 486),\n",
       " ('buckeye', 487),\n",
       " ('buckeyes', 488),\n",
       " ('bug', 489),\n",
       " ('bugat', 490),\n",
       " ('bugs', 491),\n",
       " ('buhtrap', 492),\n",
       " ('builder', 493),\n",
       " ('building', 494),\n",
       " ('built', 495),\n",
       " ('bulletin', 496),\n",
       " ('bunny', 497),\n",
       " ('bureau', 498),\n",
       " ('business', 499),\n",
       " ('businesses', 500),\n",
       " ('butler', 501),\n",
       " ('butterfly', 502),\n",
       " ('buying', 503),\n",
       " ('bypassing', 504),\n",
       " ('byte', 505),\n",
       " ('bùduì', 506),\n",
       " ('c2', 507),\n",
       " ('ca', 508),\n",
       " ('cadelle', 509),\n",
       " ('calendar', 510),\n",
       " ('calisto', 511),\n",
       " ('call', 512),\n",
       " ('called', 513),\n",
       " ('calling', 514),\n",
       " ('callisto', 515),\n",
       " ('callme', 516),\n",
       " ('calls', 517),\n",
       " ('calypso', 518),\n",
       " ('cambodia', 519),\n",
       " ('came', 520),\n",
       " ('campaign', 521),\n",
       " ('campaigns', 522),\n",
       " ('canada', 523),\n",
       " ('candidates', 524),\n",
       " ('cannon', 525),\n",
       " ('capabilities', 526),\n",
       " ('capability', 527),\n",
       " ('capable', 528),\n",
       " ('capacity', 529),\n",
       " ('capturing', 530),\n",
       " ('caracal', 531),\n",
       " ('carbanak', 532),\n",
       " ('carberp', 533),\n",
       " ('carbon', 534),\n",
       " ('card', 535),\n",
       " ('cardholder', 536),\n",
       " ('carding', 537),\n",
       " ('cards', 538),\n",
       " ('care', 539),\n",
       " ('carefully', 540),\n",
       " ('carried', 541),\n",
       " ('carries', 542),\n",
       " ('carry', 543),\n",
       " ('carrying', 544),\n",
       " ('case', 545),\n",
       " ('cases', 546),\n",
       " ('casino', 547),\n",
       " ('catchamas', 548),\n",
       " ('caucasus', 549),\n",
       " ('caught', 550),\n",
       " ('cause', 551),\n",
       " ('causes', 552),\n",
       " ('cbr', 553),\n",
       " ('cedar', 554),\n",
       " ('cell', 555),\n",
       " ('center', 556),\n",
       " ('centered', 557),\n",
       " ('central', 558),\n",
       " ('cert', 559),\n",
       " ('certain', 560),\n",
       " ('certificate', 561),\n",
       " ('certificates', 562),\n",
       " ('cfp', 563),\n",
       " ('cfr', 564),\n",
       " ('chafer', 565),\n",
       " ('chain', 566),\n",
       " ('chainshot', 567),\n",
       " ('challenge', 568),\n",
       " ('chance', 569),\n",
       " ('change', 570),\n",
       " ('changed', 571),\n",
       " ('changes', 572),\n",
       " ('changing', 573),\n",
       " ('channel', 574),\n",
       " ('channels', 575),\n",
       " ('characteristic', 576),\n",
       " ('characteristics', 577),\n",
       " ('characterized', 578),\n",
       " ('characterizes', 579),\n",
       " ('charge', 580),\n",
       " ('charger', 581),\n",
       " ('charming', 582),\n",
       " ('chasing', 583),\n",
       " ('chat', 584),\n",
       " ('chches', 585),\n",
       " ('cheap', 586),\n",
       " ('check', 587),\n",
       " ('checkpoint', 588),\n",
       " ('checks', 589),\n",
       " ('chemical', 590),\n",
       " ('chemicals', 591),\n",
       " ('chemistry', 592),\n",
       " ('chengdu', 593),\n",
       " ('cherry', 594),\n",
       " ('chile', 595),\n",
       " ('china', 596),\n",
       " ('chinastrats', 597),\n",
       " ('chinese', 598),\n",
       " ('chollima', 599),\n",
       " ('chopper', 600),\n",
       " ('chopstick', 601),\n",
       " ('chrome', 602),\n",
       " ('chuli', 603),\n",
       " ('cia', 604),\n",
       " ('circulated', 605),\n",
       " ('circumstances', 606),\n",
       " ('circumstantial', 607),\n",
       " ('cis', 608),\n",
       " ('cisco', 609),\n",
       " ('citizen', 610),\n",
       " ('citizens', 611),\n",
       " ('city', 612),\n",
       " ('civil', 613),\n",
       " ('civilian', 614),\n",
       " ('civilians', 615),\n",
       " ('claim', 616),\n",
       " ('claimed', 617),\n",
       " ('clandestine', 618),\n",
       " ('classic', 619),\n",
       " ('claudio', 620),\n",
       " ('cleans', 621),\n",
       " ('clear', 622),\n",
       " ('clicking', 623),\n",
       " ('client', 624),\n",
       " ('close', 625),\n",
       " ('closed', 626),\n",
       " ('closely', 627),\n",
       " ('cloud', 628),\n",
       " ('cloudduke', 629),\n",
       " ('cluster', 630),\n",
       " ('clusters', 631),\n",
       " ('cms', 632),\n",
       " ('cobalt', 633),\n",
       " ('cobian', 634),\n",
       " ('cobra', 635),\n",
       " ('code', 636),\n",
       " ('codename', 637),\n",
       " ('codenamed', 638),\n",
       " ('codoso', 639),\n",
       " ('coinhive', 640),\n",
       " ('cold', 641),\n",
       " ('collaborate', 642),\n",
       " ('collaborative', 643),\n",
       " ('collect', 644),\n",
       " ('collected', 645),\n",
       " ('collecting', 646),\n",
       " ('collection', 647),\n",
       " ('collectives', 648),\n",
       " ('collects', 649),\n",
       " ('colombian', 650),\n",
       " ('combination', 651),\n",
       " ('combinations', 652),\n",
       " ('combining', 653),\n",
       " ('come', 654),\n",
       " ('comes', 655),\n",
       " ('coming', 656),\n",
       " ('command', 657),\n",
       " ('commanderdll', 658),\n",
       " ('commands', 659),\n",
       " ('commercial', 660),\n",
       " ('commercially', 661),\n",
       " ('committed', 662),\n",
       " ('committee', 663),\n",
       " ('commodities', 664),\n",
       " ('commodity', 665),\n",
       " ('common', 666),\n",
       " ('commonly', 667),\n",
       " ('communicate', 668),\n",
       " ('communicating', 669),\n",
       " ('communication', 670),\n",
       " ('communications', 671),\n",
       " ('community', 672),\n",
       " ('comnie', 673),\n",
       " ('companies', 674),\n",
       " ('company', 675),\n",
       " ('compared', 676),\n",
       " ('comparison', 677),\n",
       " ('compatibility', 678),\n",
       " ('competetive', 679),\n",
       " ('compilation', 680),\n",
       " ('compile', 681),\n",
       " ('compiled', 682),\n",
       " ('complete', 683),\n",
       " ('complex', 684),\n",
       " ('complexity', 685),\n",
       " ('complicated', 686),\n",
       " ('component', 687),\n",
       " ('components', 688),\n",
       " ('composed', 689),\n",
       " ('comprehensive', 690),\n",
       " ('compression', 691),\n",
       " ('comprises', 692),\n",
       " ('comprising', 693),\n",
       " ('compromise', 694),\n",
       " ('compromised', 695),\n",
       " ('compromises', 696),\n",
       " ('compromising', 697),\n",
       " ('computer', 698),\n",
       " ('computers', 699),\n",
       " ('computing', 700),\n",
       " ('comrat', 701),\n",
       " ('conceal', 702),\n",
       " ('concentrated', 703),\n",
       " ('concentration', 704),\n",
       " ('concerned', 705),\n",
       " ('conclude', 706),\n",
       " ('concluded', 707),\n",
       " ('conclusion', 708),\n",
       " ('conclusively', 709),\n",
       " ('condensed', 710),\n",
       " ('conduct', 711),\n",
       " ('conducted', 712),\n",
       " ('conducting', 713),\n",
       " ('conducts', 714),\n",
       " ('conference', 715),\n",
       " ('confidence', 716),\n",
       " ('confidential', 717),\n",
       " ('confidentiality', 718),\n",
       " ('configuration', 719),\n",
       " ('confirm', 720),\n",
       " ('confirmed', 721),\n",
       " ('conflict', 722),\n",
       " ('confrontation', 723),\n",
       " ('confused', 724),\n",
       " ('conjunction', 725),\n",
       " ('connect', 726),\n",
       " ('connected', 727),\n",
       " ('connecting', 728),\n",
       " ('connection', 729),\n",
       " ('connections', 730),\n",
       " ('consequently', 731),\n",
       " ('considerable', 732),\n",
       " ('considered', 733),\n",
       " ('considers', 734),\n",
       " ('consistent', 735),\n",
       " ('consistently', 736),\n",
       " ('consisting', 737),\n",
       " ('consists', 738),\n",
       " ('consular', 739),\n",
       " ('consulting', 740),\n",
       " ('contact', 741),\n",
       " ('contacted', 742),\n",
       " ('contacts', 743),\n",
       " ('contain', 744),\n",
       " ('contained', 745),\n",
       " ('containing', 746),\n",
       " ('contains', 747),\n",
       " ('contemporary', 748),\n",
       " ('content', 749),\n",
       " ('contents', 750),\n",
       " ('context', 751),\n",
       " ('continually', 752),\n",
       " ('continue', 753),\n",
       " ('continued', 754),\n",
       " ('continues', 755),\n",
       " ('continuing', 756),\n",
       " ('continuous', 757),\n",
       " ('contracting', 758),\n",
       " ('contractor', 759),\n",
       " ('contractors', 760),\n",
       " ('contracts', 761),\n",
       " ('control', 762),\n",
       " ('controlled', 763),\n",
       " ('controller', 764),\n",
       " ('controls', 765),\n",
       " ('conversation', 766),\n",
       " ('converted', 767),\n",
       " ('convincing', 768),\n",
       " ('copied', 769),\n",
       " ('copies', 770),\n",
       " ('copy', 771),\n",
       " ('copying', 772),\n",
       " ('copykittens', 773),\n",
       " ('coraldeck', 774),\n",
       " ('core', 775),\n",
       " ('coreshell', 776),\n",
       " ('corkow', 777),\n",
       " ('corporate', 778),\n",
       " ('corporations', 779),\n",
       " ('corps', 780),\n",
       " ('correlate', 781),\n",
       " ('correlates', 782),\n",
       " ('correspondence', 783),\n",
       " ('correspondents', 784),\n",
       " ('cosmicduke', 785),\n",
       " ('cost', 786),\n",
       " ('cotx', 787),\n",
       " ('could', 788),\n",
       " ('counter', 789),\n",
       " ('countries', 790),\n",
       " ('country', 791),\n",
       " ('couple', 792),\n",
       " ('coupled', 793),\n",
       " ('course', 794),\n",
       " ('courtesy', 795),\n",
       " ('cover', 796),\n",
       " ('covering', 797),\n",
       " ('covert', 798),\n",
       " ('cozycar', 799),\n",
       " ('cpu', 800),\n",
       " ('cracked', 801),\n",
       " ('cracker', 802),\n",
       " ('crafted', 803),\n",
       " ('crap2p', 804),\n",
       " ('crashoverride', 805),\n",
       " ('crawler', 806),\n",
       " ('create', 807),\n",
       " ('created', 808),\n",
       " ('credential', 809),\n",
       " ('credentials', 810),\n",
       " ('credit', 811),\n",
       " ('crescent', 812),\n",
       " ('crew', 813),\n",
       " ('crews', 814),\n",
       " ('cridex', 815),\n",
       " ('crime', 816),\n",
       " ('crimeware', 817),\n",
       " ('criminal', 818),\n",
       " ('criminals', 819),\n",
       " ('crimson', 820),\n",
       " ('critical', 821),\n",
       " ('criticized', 822),\n",
       " ('crm', 823),\n",
       " ('crooks', 824),\n",
       " ('cross', 825),\n",
       " ('crossrat', 826),\n",
       " ('crouching', 827),\n",
       " ('crowdstrike', 828),\n",
       " ('cryptocurrency', 829),\n",
       " ('cryptographic', 830),\n",
       " ('cs', 831),\n",
       " ('cse', 832),\n",
       " ('ctu', 833),\n",
       " ('currency', 834),\n",
       " ('current', 835),\n",
       " ('currently', 836),\n",
       " ('custom', 837),\n",
       " ('customer', 838),\n",
       " ('customers', 839),\n",
       " ('customized', 840),\n",
       " ('cut', 841),\n",
       " ('cutting', 842),\n",
       " ('cutwail', 843),\n",
       " ('cve', 844),\n",
       " ('cyber', 845),\n",
       " ('cyberattacks', 846),\n",
       " ('cybercrime', 847),\n",
       " ('cybercriminal', 848),\n",
       " ('cybercriminals', 849),\n",
       " ('cybereason', 850),\n",
       " ('cyberespionage', 851),\n",
       " ('cybersecurity', 852),\n",
       " ('cybsec', 853),\n",
       " ('cycle', 854),\n",
       " ('cyphort', 855),\n",
       " ('cyprus', 856),\n",
       " ('cyrillic', 857),\n",
       " ('dagger', 858),\n",
       " ('dalai', 859),\n",
       " ('damage', 860),\n",
       " ('damaging', 861),\n",
       " ('damn', 862),\n",
       " ('dark', 863),\n",
       " ('darkcomet', 864),\n",
       " ('darkhotel', 865),\n",
       " ('darkmatter', 866),\n",
       " ('darkseoul', 867),\n",
       " ('darkvishnya', 868),\n",
       " ('darkweb', 869),\n",
       " ('data', 870),\n",
       " ('databases', 871),\n",
       " ('date', 872),\n",
       " ('dates', 873),\n",
       " ('dating', 874),\n",
       " ('day', 875),\n",
       " ('daybreak', 876),\n",
       " ('days', 877),\n",
       " ('ddkong', 878),\n",
       " ('ddos', 879),\n",
       " ('dealerschoice', 880),\n",
       " ('dealt', 881),\n",
       " ('debate', 882),\n",
       " ('debian', 883),\n",
       " ('decade', 884),\n",
       " ('decedent', 885),\n",
       " ('december', 886),\n",
       " ('deception', 887),\n",
       " ('declared', 888),\n",
       " ('decline', 889),\n",
       " ('decloaked', 890),\n",
       " ('decoy', 891),\n",
       " ('decoys', 892),\n",
       " ('dedicated', 893),\n",
       " ('deemed', 894),\n",
       " ('deep', 895),\n",
       " ('deepen', 896),\n",
       " ('deeper', 897),\n",
       " ('defacement', 898),\n",
       " ('defacements', 899),\n",
       " ('defence', 900),\n",
       " ('defendants', 901),\n",
       " ('defense', 902),\n",
       " ('defenses', 903),\n",
       " ('definite', 904),\n",
       " ('definitions', 905),\n",
       " ('definitively', 906),\n",
       " ('deletes', 907),\n",
       " ('deleting', 908),\n",
       " ('delineated', 909),\n",
       " ('deliver', 910),\n",
       " ('delivered', 911),\n",
       " ('delivery', 912),\n",
       " ('dell', 913),\n",
       " ('delphi', 914),\n",
       " ('demand', 915),\n",
       " ('demands', 916),\n",
       " ('democratic', 917),\n",
       " ('demonstrate', 918),\n",
       " ('demonstrated', 919),\n",
       " ('dendroid', 920),\n",
       " ('denial', 921),\n",
       " ('denied', 922),\n",
       " ('department', 923),\n",
       " ('departments', 924),\n",
       " ('departure', 925),\n",
       " ('deploy', 926),\n",
       " ('deployed', 927),\n",
       " ('deploying', 928),\n",
       " ('deployment', 929),\n",
       " ('deployments', 930),\n",
       " ('deploys', 931),\n",
       " ('deputy', 932),\n",
       " ('deputydog', 933),\n",
       " ('derived', 934),\n",
       " ('derusbi', 935),\n",
       " ('desai', 936),\n",
       " ('describe', 937),\n",
       " ('described', 938),\n",
       " ('describing', 939),\n",
       " ('description', 940),\n",
       " ('design', 941),\n",
       " ('designated', 942),\n",
       " ('designating', 943),\n",
       " ('designator', 944),\n",
       " ('designed', 945),\n",
       " ('desktop', 946),\n",
       " ('despite', 947),\n",
       " ('destover', 948),\n",
       " ('destroyed', 949),\n",
       " ('destroyer', 950),\n",
       " ('destruction', 951),\n",
       " ('destructive', 952),\n",
       " ('detail', 953),\n",
       " ('detailed', 954),\n",
       " ('details', 955),\n",
       " ('detect', 956),\n",
       " ('detected', 957),\n",
       " ('detection', 958),\n",
       " ('determination', 959),\n",
       " ('determine', 960),\n",
       " ('determined', 961),\n",
       " ('develop', 962),\n",
       " ('developed', 963),\n",
       " ('developer', 964),\n",
       " ('developers', 965),\n",
       " ('development', 966),\n",
       " ('device', 967),\n",
       " ('devices', 968),\n",
       " ('dialogue', 969),\n",
       " ('diaspora', 970),\n",
       " ('dib', 971),\n",
       " ('dict', 972),\n",
       " ('differences', 973),\n",
       " ('different', 974),\n",
       " ('differs', 975),\n",
       " ('difficult', 976),\n",
       " ('difficulty', 977),\n",
       " ('digital', 978),\n",
       " ('dignitaries', 979),\n",
       " ('diplomacy', 980),\n",
       " ('diplomat', 981),\n",
       " ('diplomatic', 982),\n",
       " ('dipsind', 983),\n",
       " ('direct', 984),\n",
       " ('directed', 985),\n",
       " ('direction', 986),\n",
       " ('directly', 987),\n",
       " ('director', 988),\n",
       " ('directorate', 989),\n",
       " ('disabled', 990),\n",
       " ('disappear', 991),\n",
       " ('disclosure', 992),\n",
       " ('discovered', 993),\n",
       " ('discovery', 994),\n",
       " ('discrediting', 995),\n",
       " ('discussed', 996),\n",
       " ('disguised', 997),\n",
       " ('disinformation', 998),\n",
       " ('disk', 999),\n",
       " ...]"
      ]
     },
     "execution_count": 168,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 171,
   "metadata": {},
   "outputs": [],
   "source": [
    "#transforming of our test and train input data into vectors\n",
    "X_train = vectorizer.transform(sentences_train)\n",
    "X_test  = vectorizer.transform(sentences_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 172,
   "metadata": {},
   "outputs": [],
   "source": [
    "X=np.array(X_train.todense())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 133,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.9680162271805274\n"
     ]
    }
   ],
   "source": [
    "from numpy import count_nonzero\n",
    "sparsity = 1.0 - ( count_nonzero(X) / float(X.size) )\n",
    "print(sparsity)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.9393939393939394\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\SRIKANTH\\AppData\\Roaming\\Python\\Python37\\site-packages\\sklearn\\linear_model\\logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning.\n",
      "  FutureWarning)\n"
     ]
    }
   ],
   "source": [
    "# Applying logistic regression model on our vectorized data and checking \n",
    "classifier = LogisticRegression()\n",
    "classifier.fit(X_train, y_train)\n",
    "score = classifier.score(X_test, y_test)\n",
    "print(score)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred  = classifier.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics import accuracy_score\n",
    "score = accuracy_score(y_pred, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.9393939393939394"
      ]
     },
     "execution_count": 116,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "score"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "metadata": {},
   "outputs": [],
   "source": [
    "text='hello is threat group that '"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['vectorizer.sav']"
      ]
     },
     "execution_count": 118,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# storing model and using joblib\n",
    "filename = 'finalized_model.sav'\n",
    "vec = 'vectorizer.sav'\n",
    "joblib.dump(classifier, filename)\n",
    "joblib.dump(vectorizer, vec)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "metadata": {},
   "outputs": [],
   "source": [
    "# loading model\n",
    "loaded_model = joblib.load(filename)\n",
    "vec_model = joblib.load(vec)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 121,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0])"
      ]
     },
     "execution_count": 121,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# predicting new text upon our model\n",
    "text='''erience of cities and countries that have pushed back this virus give hope and courage to the rest of the world.'''\n",
    "loaded_model.predict(test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
